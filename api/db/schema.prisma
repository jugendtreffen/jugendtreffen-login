generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native"]
}

datasource db {
  provider  = "postgresql"
  url       = env("SUPABASE_TRANSACTION_POOLER_URL")
  directUrl = env("SUPABASE_SESSION_POOLER_URL")
}

model PersonalData {
  id                    String   @id @db.Uuid
  name                  String
  familyName            String
  birthdate             DateTime
  gender                String
  phoneNumber           String
  phoneCaretakerContact String?
  foundUsBy             String?
  isParent              Boolean  @default(false)
  country               String
  city                  String
  postalCode            String
  address               String
  role                  String
  createdAt             DateTime @default(now())

  @@map("personalDatas")
}

model Participation {
  id                BigInt   @id @default(autoincrement()) @db.BigInt
  travelMethod      String?
  accommodation     String
  startDate         DateTime
  endDate           DateTime
  foodChoice        String
  acceptPhotos      Boolean
  acceptCoC         Boolean
  firstTimeAttending Boolean
  eventId           BigInt   @db.BigInt
  userId            String   @db.Uuid
  event             Event    @relation(fields: [eventId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  participationRole String?

  @@index([userId])
  @@map("participations")
}

model Event {
  id             BigInt          @id @default(autoincrement()) @db.BigInt
  name           String          @unique
  desc           String?
  startDate      DateTime
  endDate        DateTime
  participations Participation[]
  presences      Presence[]
  createdAt      DateTime        @default(now())

  @@map("events")
}

model Presence {
  id      BigInt   @id @default(autoincrement()) @db.BigInt
  date    DateTime
  status  String
  userId  String   @db.Uuid
  eventId BigInt   @db.BigInt
  event   Event    @relation(fields: [eventId], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@index([userId])
  @@map("presences")
}
